/**
 * NewPage Accessibility Styles
 * 
 * Ensures WCAG 2.1 AA compliance for the New page:
 * - Reduced motion support (Requirements: 10.1)
 * - Touch target sizes (Requirements: 10.2)
 * - Text contrast compliance (Requirements: 10.3)
 * - Focus indicators (Requirements: 10.5)
 * - ARIA support (Requirements: 10.6)
 */

/* ============================================
 * REDUCED MOTION SUPPORT
 * Requirements: 10.1
 * Disables non-essential animations when user prefers reduced motion
 * ============================================ */

@media (prefers-reduced-motion: reduce) {
  /* Disable all NewPage animations */
  .new-page *,
  .new-page *::before,
  .new-page *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Thread card animations */
  .new-page__thread-item {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }

  .thread-card {
    transition: none !important;
  }

  .thread-card:hover {
    transform: none !important;
  }

  .thread-card--slide-out,
  .thread-card--pulse-glow,
  .thread-card--fade-out {
    animation: none !important;
  }

  /* Risk indicator pulse */
  .thread-card__risk-dot {
    animation: none !important;
  }

  .thread-card__overdue {
    animation: none !important;
  }

  /* Header animations */
  .new-page__sync-icon {
    animation: none !important;
  }

  .new-page__urgent-badge {
    animation: none !important;
  }

  /* Batch mode animations */
  .new-page__batch-hint {
    animation: none !important;
  }

  .batch-action-bar {
    animation: none !important;
  }

  .batch-action-bar__count-number {
    animation: none !important;
  }

  /* Filter chips */
  .filter-chip {
    transition: none !important;
  }

  /* Pull-to-refresh */
  .new-page__pull-icon {
    transition: none !important;
  }

  .new-page__pull-icon--spinning {
    animation: none !important;
  }

  /* Preview panel */
  .thread-preview-panel {
    animation: none !important;
    transition: none !important;
  }

  /* Snooze overlay */
  .snooze-overlay {
    animation: none !important;
  }

  .snooze-overlay__content {
    animation: none !important;
  }

  /* Toast notifications */
  .toast {
    animation: none !important;
  }

  /* New threads banner */
  .new-threads-banner {
    animation: none !important;
  }

  /* Empty state particles */
  .animated-empty-state__particle {
    animation: none !important;
  }

  /* Loading skeleton shimmer */
  .new-page-skeleton__card {
    animation: none !important;
  }
}

/* ============================================
 * TOUCH TARGET SIZES
 * Requirements: 10.2
 * Ensures all interactive elements are minimum 44x44px
 * ============================================ */

/* Buttons */
.new-page__refresh-button,
.batch-action-bar__button,
.batch-action-bar__cancel,
.filter-chip,
.thread-card__expand,
.thread-card__checkbox input[type="checkbox"],
.snooze-overlay__option,
.new-threads-banner__button,
.new-page-error__retry-button {
  min-width: 44px;
  min-height: 44px;
}

/* Thread card checkbox - ensure touch target */
.thread-card__checkbox {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.thread-card__checkbox input[type="checkbox"] {
  width: 24px;
  height: 24px;
  /* Padding to reach 44px touch target */
  padding: 10px;
  box-sizing: content-box;
}

/* Expand button touch target */
.thread-card__expand {
  min-width: 44px;
  min-height: 44px;
  padding: 6px;
}

/* Filter chips touch target */
.filter-chip {
  min-height: 44px;
  padding: 10px 16px;
}

/* Batch action buttons */
.batch-action-bar__button {
  min-height: 44px;
  padding: 10px 16px;
}

.batch-action-bar__cancel {
  min-width: 44px;
  min-height: 44px;
  padding: 10px;
}

/* Snooze options */
.snooze-overlay__option {
  min-height: 44px;
  padding: 12px 16px;
}

/* New threads banner button */
.new-threads-banner__button {
  min-height: 44px;
  padding: 10px 20px;
}

/* Error retry button */
.new-page-error__retry-button {
  min-height: 44px;
  padding: 12px 24px;
}

/* ============================================
 * TEXT CONTRAST COMPLIANCE
 * Requirements: 10.3
 * Ensures all text meets WCAG AA 4.5:1 ratio
 * ============================================ */

/* Primary text - White on dark background */
.new-page,
.thread-card__subject,
.batch-action-bar__count-number,
.new-page__title {
  color: #FFFFFF; /* 21:1 contrast on #0A0A0F */
}

/* Secondary text - Minimum 4.5:1 contrast */
.thread-card__participants,
.thread-card__summary,
.thread-card__timestamp,
.filter-chip__label,
.batch-action-bar__count-label,
.new-page__count {
  color: rgba(255, 255, 255, 0.7); /* ~7:1 contrast on dark */
}

/* Ensure muted text still meets minimum contrast */
.thread-card__participant-more,
.filter-chip__count {
  color: rgba(255, 255, 255, 0.6); /* ~4.5:1 contrast - minimum AA */
}

/* Badge text - ensure contrast on colored backgrounds */
.thread-card__classification,
.thread-card__risk,
.thread-card__overdue,
.thread-card__draft {
  font-weight: 600; /* Bold for better readability */
}

/* Error text - high contrast red */
.new-page-error__message {
  color: #FF6B6B; /* Lighter red for better contrast */
}

/* ============================================
 * FOCUS INDICATORS
 * Requirements: 10.5
 * Visible focus indicators with cyan glow
 * ============================================ */

/* Default focus indicator */
.new-page *:focus-visible {
  outline: 2px solid var(--neon-cyan, #00D4FF);
  outline-offset: 2px;
  box-shadow: 0 0 0 4px rgba(0, 212, 255, 0.25);
}

/* Thread card focus */
.thread-card:focus-visible {
  outline: 2px solid var(--neon-cyan, #00D4FF);
  outline-offset: 2px;
  box-shadow: 
    0 0 0 4px rgba(0, 212, 255, 0.25),
    0 0 20px rgba(0, 212, 255, 0.3);
}

/* Button focus */
.new-page__refresh-button:focus-visible,
.batch-action-bar__button:focus-visible,
.batch-action-bar__cancel:focus-visible,
.filter-chip:focus-visible,
.thread-card__expand:focus-visible,
.snooze-overlay__option:focus-visible,
.new-threads-banner__button:focus-visible,
.new-page-error__retry-button:focus-visible {
  outline: 2px solid var(--neon-cyan, #00D4FF);
  outline-offset: 2px;
  box-shadow: 
    0 0 0 4px rgba(0, 212, 255, 0.25),
    0 0 15px rgba(0, 212, 255, 0.4);
}

/* Checkbox focus */
.thread-card__checkbox input[type="checkbox"]:focus-visible {
  outline: 2px solid var(--neon-cyan, #00D4FF);
  outline-offset: 2px;
  box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
}

/* Remove default focus outline when custom is applied */
.new-page button:focus:not(:focus-visible),
.new-page input:focus:not(:focus-visible) {
  outline: none;
}

/* ============================================
 * SCREEN READER SUPPORT
 * Requirements: 10.6
 * ============================================ */

/* Visually hidden but accessible to screen readers */
.new-page .sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Skip link for keyboard navigation */
.new-page__skip-link {
  position: absolute;
  top: -100px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--neon-cyan, #00D4FF);
  color: var(--bg-primary, #0A0A0F);
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 600;
  text-decoration: none;
  z-index: 10000;
  transition: top 0.2s ease;
}

.new-page__skip-link:focus {
  top: 16px;
  box-shadow: 0 0 20px var(--neon-cyan, #00D4FF);
}

/* Live region for dynamic announcements */
.new-page__live-region {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ============================================
 * HIGH CONTRAST MODE
 * Enhanced visibility for users who need higher contrast
 * ============================================ */

@media (prefers-contrast: high) {
  .thread-card {
    border: 2px solid rgba(255, 255, 255, 0.5);
  }

  .thread-card:hover {
    border-color: var(--neon-cyan, #00D4FF);
  }

  .filter-chip {
    border: 2px solid rgba(255, 255, 255, 0.3);
  }

  .filter-chip--active {
    border: 2px solid var(--neon-cyan, #00D4FF);
  }

  .batch-action-bar__button {
    border: 2px solid currentColor;
  }

  /* Stronger focus indicators */
  .new-page *:focus-visible {
    outline: 3px solid var(--neon-cyan, #00D4FF);
    outline-offset: 3px;
    box-shadow: 0 0 0 6px rgba(0, 212, 255, 0.4);
  }
}
