
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend[39m

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.577Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread a910c00e-09d7-585c-8010-9a616b82f9e0:","error":{"name":"SyntaxError","message":"Unexpected token 'k', \"key\" is not valid JSON","stack":"SyntaxError: Unexpected token 'k', \"key\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.602Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 5a67a53c-01ad-41a9-8838-0630c351eead:","error":{"name":"SyntaxError","message":"Unexpected token 'k', \"key\" is not valid JSON","stack":"SyntaxError: Unexpected token 'k', \"key\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.603Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 493bbb59-ac66-35cc-a341-ec853f8e746a:","error":{"name":"SyntaxError","message":"Unexpected token 'k', \"key\" is not valid JSON","stack":"SyntaxError: Unexpected token 'k', \"key\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 3)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.608Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread c42edc5e-abb6-1272-a5be-9dc99e249ac0:","error":{"name":"SyntaxError","message":"Unexpected token 'k', \"key\" is not valid JSON","stack":"SyntaxError: Unexpected token 'k', \"key\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 4)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.618Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 6d9b85a5-58d2-40be-90f1-1d019e94ccdf:","error":{"name":"SyntaxError","message":"Unexpected token 'x', \"x&u\"\" is not valid JSON","stack":"SyntaxError: Unexpected token 'x', \"x&u\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.619Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 1dc2ed5b-0754-4af8-9e20-689252ca742c:","error":{"name":"SyntaxError","message":"Unexpected token 'x', \"x&u\"\" is not valid JSON","stack":"SyntaxError: Unexpected token 'x', \"x&u\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.619Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 57d2baa2-7552-1860-b0b3-6839364d6ddd:","error":{"name":"SyntaxError","message":"Unexpected token 'x', \"x&u\"\" is not valid JSON","stack":"SyntaxError: Unexpected token 'x', \"x&u\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 3)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.621Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread ffffffe1-8d3b-5a3b-9c64-ca6200000007:","error":{"name":"SyntaxError","message":"Unexpected token '&', \"&E]c,Lvx_\" is not valid JSON","stack":"SyntaxError: Unexpected token '&', \"&E]c,Lvx_\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.625Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread b611c060-f9a7-299d-9038-dcb5ffffffed:","error":{"name":"SyntaxError","message":"Unexpected token '~', \"~!$!\"\" is not valid JSON","stack":"SyntaxError: Unexpected token '~', \"~!$!\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.626Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread d50bfaed-0017-1000-8000-000600000013:","error":{"name":"SyntaxError","message":"Unexpected token '~', \"~!$!\"\" is not valid JSON","stack":"SyntaxError: Unexpected token '~', \"~!$!\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 2)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.627Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 0000000d-0014-1000-9453-fa95f3d6ce10:","error":{"name":"SyntaxError","message":"Unexpected token '~', \"~!$!\"\" is not valid JSON","stack":"SyntaxError: Unexpected token '~', \"~!$!\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 3)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.628Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 43ac8426-b432-5943-8000-0002bdcf966b:","error":{"name":"SyntaxError","message":"Unexpected token '~', \"~!$!\"\" is not valid JSON","stack":"SyntaxError: Unexpected token '~', \"~!$!\"\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 4)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.635Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 2965cf1b-ad10-3d5f-889e-eebddc1f100f:","error":{"name":"SyntaxError","message":"Unexpected token 'v', \"valueOf\" is not valid JSON","stack":"SyntaxError: Unexpected token 'v', \"valueOf\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.636Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 47cfe14b-9846-5853-86cd-7d07128013ed:","error":{"name":"SyntaxError","message":"Unexpected token 'v', \"valueOf\" is not valid JSON","stack":"SyntaxError: Unexpected token 'v', \"valueOf\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 3)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.637Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 8230cfcd-e93e-1675-9547-5eed5671d123:","error":{"name":"SyntaxError","message":"Unexpected token 'v', \"valueOf\" is not valid JSON","stack":"SyntaxError: Unexpected token 'v', \"valueOf\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 4)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.643Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 9e33ff5a-497e-3ae6-92f8-f71cf061e49e:","error":{"name":"SyntaxError","message":"Unexpected token 'c', \"c_%/Q(\" is not valid JSON","stack":"SyntaxError: Unexpected token 'c', \"c_%/Q(\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 2)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.647Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread d1039182-17ff-134b-8ea6-ec046f29c37e:","error":{"name":"SyntaxError","message":"Unexpected token '#', \"#=Eztz$\" is not valid JSON","stack":"SyntaxError: Unexpected token '#', \"#=Eztz$\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.651Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 00000016-001c-1000-8000-0015a51232f8:","error":{"name":"SyntaxError","message":"Unexpected token 'L', \"Lc9/p\" is not valid JSON","stack":"SyntaxError: Unexpected token 'L', \"Lc9/p\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.652Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 96962e75-3c11-36e0-9675-71fc0000001f:","error":{"name":"SyntaxError","message":"Unexpected token 'L', \"Lc9/p\" is not valid JSON","stack":"SyntaxError: Unexpected token 'L', \"Lc9/p\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.653Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread fffffff1-6a93-401a-9d6f-45489b5d87d9:","error":{"name":"SyntaxError","message":"Unexpected token 'L', \"Lc9/p\" is not valid JSON","stack":"SyntaxError: Unexpected token 'L', \"Lc9/p\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 4)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.655Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 729a9113-4521-2ee1-9fe2-c71e1fcd5852:","error":{"name":"SyntaxError","message":"Unexpected token 'b', \"bov%\" is not valid JSON","stack":"SyntaxError: Unexpected token 'b', \"bov%\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.658Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 00000013-fff2-5fff-aaaa-7f606d871e6f:","error":{"name":"SyntaxError","message":"Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.663Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread e1ef1a1f-3783-4d30-942f-678a63f9222e:","error":{"name":"SyntaxError","message":"Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON","stack":"SyntaxError: Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.663Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread f1cd735c-2602-25cf-aa11-673562131a2c:","error":{"name":"SyntaxError","message":"Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON","stack":"SyntaxError: Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.664Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread bd1e7a84-0ed3-565a-bc92-a2e60372a1d8:","error":{"name":"SyntaxError","message":"Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON","stack":"SyntaxError: Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 2)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.665Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 298cf1a7-b2ed-1467-b9ce-609a49e01638:","error":{"name":"SyntaxError","message":"Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON","stack":"SyntaxError: Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 3)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.665Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 1c444310-e7c2-53cf-ad93-f0b775502eae:","error":{"name":"SyntaxError","message":"Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON","stack":"SyntaxError: Unexpected token 'R', \"tR!BV-teM)\" is not valid JSON\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 4)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

[90mstderr[2m | src/services/email-triage.service.test.ts[2m > [22m[2mEmailTriageService[2m > [22m[2mProperty-Based Tests[2m > [22m[2mshould always return a valid GlobalTriageReport regardless of AI response content
[22m[39m{"timestamp":"2026-01-12T22:15:51.669Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 082e6674-5582-38ef-a03d-d00e18059a0e:","error":{"name":"SyntaxError","message":"Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 0)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.671Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread 5f4a1ac1-fa2e-3099-8eb7-487cfffffffb:","error":{"name":"SyntaxError","message":"Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 1)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}
{"timestamp":"2026-01-12T22:15:51.672Z","level":"error","message":"[EmailTriageService] AI Triage failed for thread ae06d0a1-bc3e-44b0-b461-60db5f41cdc7:","error":{"name":"SyntaxError","message":"Unexpected end of JSON input","stack":"SyntaxError: Unexpected end of JSON input\n    at JSON.parse (<anonymous>)\n    at EmailTriageService.triageThread (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:144:33)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:78:28\n    at async Promise.all (index 2)\n    at EmailTriageService.generateFullTriageReport (/Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.ts:77:9)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:122:40\n    at AsyncProperty.run (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/property/AsyncProperty.generic.js:46:28)\n    at asyncRunIt (file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/fast-check/lib/esm/check/runner/Runner.js:33:21)\n    at /Users/hamishmcgee/Desktop/ZenaAntigravity/packages/backend/src/services/email-triage.service.test.ts:86:13\n    at file:///Users/hamishmcgee/Desktop/ZenaAntigravity/node_modules/@vitest/runner/dist/index.js:915:20"}}

 [32mâœ“[39m src/services/email-triage.service.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 203[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m3 passed[39m[22m[90m (3)[39m
[2m   Start at [22m 11:15:50
[2m   Duration [22m 1.43s[2m (transform 439ms, setup 176ms, import 610ms, tests 203ms, environment 0ms)[22m

